pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
-- weather, darcy lugt-falk --
-- lone paperclip --
function init_refresh_anim()
		
		-- the tween function, takes args:
		-- p - your object
		-- table - table with the target values you want
		-- 1 (optional) - time (in seconds) in what your value should end with your target value, default is 1
		-- "quad_in_out" - easing function, you can look up all defined functions in the tab 1, I've implemented a few examples from https://easings.net/
		local v=tween(loading_anim,{x=(loading_anim.x==118 and 12 or 118),y=128-10-5},1,"quad_in_out")
		v.onend=function()
			init_refresh_anim()
		end
		v.delay=0
end

function _init()
loading_anim = {x=13,y=128-10-5}
		init_refresh_anim()
		
		reset_pins()
		alphabet = {"a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p",
"q", "r", "s", "t", "u", "v", "w", "x", "y", "z","/", ",", " ", "-" }
		set_working("web")
		set_pin(1,0)

		string_to_pins("loading", 2)
		
end


function _draw()

	cls(12)
	--print(alphabet[get_pin(2)+1])
	clouds()
	print("the temperature in ",10,10,1)
	print(pins_to_string(2,50).." is",10,17)
	print(get_pin(1).." degrees",10,17+7,10)
	print("press ❎ to reload",10,128-10,5)
	if whos_working() =="web" then
		line(10,128-10-5,118,128-10-5)
		circfill(loading_anim.x,loading_anim.y,2,6)
		--print("refreshing...",10,128-10-5-2,6)
	end
end

function _update60()
	if btnp(❎) then
		set_pin(0,1)
	end
	if whos_working() == "web" then
		tween_update(1/60)
	end
end
-->8
-- draws --
function clouds()
	circfill(10,128,30,7)
	circfill(40,128,25,7)
	circfill(50,128,27,7)
	circfill(80,120,25,7)
	circfill(100,140,40,7)
	circfill(128,128,25,7)
end
-->8
-- pin logic --
function set_pin(pin,value) --pin : pin between 0 and 127
	poke(0x5f80+pin, value) --value : the value between 0 and 255
end

function get_pin(pin) --pin : the pin do you want to get the value
	return peek(0x5f80+pin)
end


function whos_working()

	if get_pin(0) == 1 then
		return "web"
	else
		return "pico"
		
	end

end

function set_working(_worker)
	if _worker == "web"  then set_pin(0,1) end
	if _worker == "pico" then set_pin(0,0) end
end

function pins_to_string(_pins_start, _pins_end)
	
	_final_string = ""
	for i = _pins_start, _pins_end do
		if get_pin(i) ~= 255 then
			_final_string = _final_string .. alphabet[get_pin(i)+1]
		end
	end
	return _final_string
end

function string_to_pins(_string, _pins_start)
	for i = 1,#_string do
		_char = sub(_string,i,i)
		index={}
		for k,v in pairs(alphabet) do
			index[v]=k
		end
		
		set_pin(_pins_start+i,index[_char]-1)
	end
end

function reset_pins()
	for i = 0,180 do
		set_pin(i,255)
	end
end

-->8
--tween--

local back=1.70158

functions={
["linear"]=function(t) return t end,
["quad_out"]=function(t) return -t*(t-2) end,
["quad_in"]=function(t) return t*t end,
["quad_in_out"]=function(t) t=t*2 if(t<1) return 0.5*t*t
	return -0.5*((t-1)*(t-3)-1) end,
["back_in"]=function(t) local s=back	return t*t*((s+1)*t-s) end,
["back_out"]=function(t) local s=back t-=1 return t*t*((s+1)*t+s)+1 end,
["back_in_out"]=function(t) local s=back t*=2 if (t<1) s*=1.525 return 0.5*(t*t*((s+1)*t-s))
 t-=2 s*=1.525	return 0.5*(t*t*((s+1)*t+s)+2) end
}

local tasks={}

function tween(o,vl,t,fn)
 local task={
  vl={},
  rate=t or 1,
  o=o,
  progress=0,
  delay=0,
  fn=functions[fn or "quad_out"]
 }
 
 for k,v in pairs(vl) do
  local x=o[k]
  task.vl[k]={start=x,diff=v-x}
 end
 
 add(tasks,task)
 return task
end

function tween_update(dt)
 for t in all(tasks) do
  if t.delay>0 then
   t.delay-=dt
  else
   t.progress+=dt/t.rate  
   local p=t.progress
   local x=t.fn(p>=1 and 1 or p)
   for k,v in pairs(t.vl) do
    t.o[k]=v.start+v.diff*x
   end
   
   if p>=1 then
    del(tasks,t)
    if (t.onend) t.onend()
   end 
  end
 end
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000ccc0c0c0ccc00000ccc0ccc0ccc0ccc0ccc0ccc0ccc0ccc0c0c0ccc0ccc00000ccc0cc000000000000000000000000000000000000000000000000
00000000000c00c0c0c00000000c00c000ccc0c0c0c000c0c0c0c00c00c0c0c0c0c00000000c00c0c00000000000000000000000000000000000000000000000
00000000000c00ccc0cc0000000c00cc00c0c0ccc0cc00cc00ccc00c00c0c0cc00cc0000000c00c0c00000000000000000000000000000000000000000000000
00000000000c00c0c0c00000000c00c000c0c0c000c000c0c0c0c00c00c0c0c0c0c00000000c00c0c00000000000000000000000000000000000000000000000
00000000000c00c0c0ccc000000c00ccc0c0c0c000ccc0c0c0c0c00c000cc0c0c0ccc00000ccc0c0c00000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000c0000cc0ccc0cc00ccc0cc000cc00000ccc00cc0000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000c000c0c0c0c0c0c00c00c0c0c00000000c00c000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000c000c0c0ccc0c0c00c00c0c0c00000000c00ccc0000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000c000c0c0c0c0c0c00c00c0c0c0c000000c0000c0000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000ccc0cc00c0c0ccc0ccc0c0c0ccc00000ccc0cc00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000aaa00000aa00aaa00aa0aaa0aaa0aaa00aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000a0a00000a0a0a000a000a0a0a000a000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000a0a00000a0a0aa00a000aa00aa00aa00aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000a0a00000a0a0a000a0a0a0a0a000a00000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000aaa00000aaa0aaa0aaa0a0a0aaa0aaa0aa000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006660666066606660666006606060666066000660000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006060600060006060600060006060060060606000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006600660066006600660066606660060060606000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006060600060006060600000606060060060606060000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006060666060006060666066006060666060606660060006000600000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000005550555055500550055000000555550000005550055000005550555050000550555055000000000000000000000000000000000000000000000000
00000000005050505050005000500000005505055000000500505000005050500050005050505050500000000000000000000000000000000000000000000000
00000000005550550055005550555000005550555000000500505000005500550050005050555050500000000000000000000000000000000000000000000000
00000000005000505050000050005000005505055000000500505000005050500050005050505050500000000000000000000000000000000000000000000000
00000000005000505055505500550000000555550000000500550000005050555055505500505055500000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

